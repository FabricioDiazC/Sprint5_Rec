<!-- Creamos una tabla con borde para mostrar los datos -->
<table border="1">

  <!-- Encabezado de la tabla con nombres de las columnas -->
  <thead>
    <tr>
      <th>Nombre</th>
      <th>Capital</th>
      <th>Fronteras</th>
      <th>Área(en km²)</th>
      <th>Población</th>
      <th>Gini</th>
      <th>Zonas Horarias</th>
      <th>Creador</th>
      <th>Acciones</th>
    </tr>
  </thead>

  <!-- Cuerpo de la tabla: se llena recorriendo el array de países -->
  <tbody>
    <% paises.forEach(p => { %>
      <tr>
        <!-- Nombre del país (formato anidado o texto simple según cómo esté guardado) -->
        <td><%= p.name?.spa?.official || (typeof p.name === 'string' ? p.name : '—') %></td>
        <!-- Capital/es separadas por coma -->
        <td><%= p.capital?.join(', ') %></td>
        <!-- Fronteras (códigos de país separados por coma) -->
        <td><%= p.borders?.join(', ') %></td>
        <!-- Área total en km² -->
        <td><%= p.area %></td>
        <!-- Población -->
        <td><%= p.population %></td>
        <!-- Índice Gini si existe, sino un guión -->
        <td><%= p.gini || '-' %></td>
        <!-- Zonas horarias separadas por coma -->
        <td><%= p.timezones?.join(', ') %></td>
        <!-- Nombre de quien creó el país (normalmente "Fabricio Diaz") -->
        <td><%= p.creador %></td>
        <!-- Acciones: editar o eliminar -->
        <td>
          <!-- Botón para editar (link a formulario de edición) -->
          <a class="btn-action btn-edit" href="/paises/editar/<%= p._id %>">Editar</a> 
          <!-- Formulario para eliminar (método POST con botón) -->
        <form
        action="/paises/eliminar/<%= p._id %>"
        method="POST"
        style="display: inline"
        onsubmit="return confirm('¿Estás seguro de que deseas eliminar este país? Esta acción no se puede deshacer.');"
        >
        <button type="submit">Eliminar</button>
        </form>
        </td>
      </tr>
    <% }) %>
    <!-- Fila final con los totales generales -->
    <tr class="totals-row">
      <td colspan="3"><strong>Totales</strong></td>
      
      <%# El total del área, ahora en la columna correcta %>
      <td><%= totalArea.toLocaleString('es-ES') %> km²</td>
      
      <%# El total de población, formateado para mayor legibilidad %>
      <td><%= totalPoblacion.toLocaleString('es-ES') %></td>

      <%# El promedio de Gini %>
      <td><%= promedioGini %></td>

      <%# Celdas vacías para mantener la estructura de la tabla %>
      <td colspan="3"></td>
    </tr>
  </tbody>
</table>